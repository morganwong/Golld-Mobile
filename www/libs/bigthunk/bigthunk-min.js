function BTAjax(t){this.mcla_commQ=new Array,this.mstr_coreURL=void 0!==t?t:"",this.debugging=!1;var e=this;this.pushToQ=function(t,n,r,i){var s={url:e.mstr_coreURL+t,post:n,callback:r,fail:i};e.mcla_commQ.push(s),e.debugging&&trace("pushed "+t+" into q of length "+e.mcla_commQ.length)}}function debugging(t){this.debugging=t}function BTStatus(){}BTAjax.prototype.execute=function(){if(0!=this.mcla_commQ.length){var t=this.mcla_commQ.shift(),e=this;e.debugging&&trace("calling "+t.url),$.ajax({url:t.url,type:"POST",timeout:15e3,data:t.post,dataType:"json",success:function(n){"ok"==n.status?(t.callback(n.result),e.debugging&&trace("callback completed...next in q of length "+that.mcla_commQ.length),e.execute()):void 0!==t.fail&&t.fail(n.message)}})}},BTStatus.prototype.setCallbackInfo=function(t,e,n){this.time=t,this.callbackURL=e,this.handler=n},BTStatus.prototype.setServerComm=function(t,e){function n(){trace("poll running");var t=new BTAjax;t.pushToQ(i.callbackURL,{id:i.id},r),t.execute()}function r(t){trace("result = "+t),i.handler(t),"No status"==t&&clearInterval(i.poller)}this.initialReqURL=t,this.initialReqPost=e,this.comm=new BTAjax;var i=this;this.comm.pushToQ(t,e,function(t){i.id=t,i.poller=setInterval(n,i.time)})},BTStatus.prototype.execute=function(){this.comm.execute()};var BTAjax,ajaxCall;ajaxCall=function(t,e,n,r){return BTGlobals.netLogging&&trace("calling ajax : "+t),$.ajax({url:t,type:"POST",timeout:15e3,data:e,dataType:"json",success:function(t){return BTGlobals.netLogging&&trace("got response back","ajaxCall.success"),BTGlobals.netLogging&&trace(""+t,"ajaxCall.success"),"ok"===t.status&&null!=n?n(t.result):null!=r?r(t.message):trace(t)},error:function(t,e,n){var i;return trace("an error occurred---------"),trace(n),trace(e),trace(t),trace("---------"),i="An error occurred communicating with the server. Cause : "+n,null!=r?r(i):void 0}})},BTAjax={timeout:15e3,get:function(t,e,n){return trace(t),$.ajax({url:t,type:"GET",timeout:BTAjax.timeout,dataType:"json",success:function(t){return BTAjax.processSuccess(t,e,n)}})},post:function(t,e,n,r){return trace(t),$.ajax({url:t,type:"POST",timeout:BTAjax.timeout,dataType:"json",data:e,success:function(t){return BTAjax.processSuccess(t,n,r)}})},"delete":function(t,e,n){return trace(t),$.ajax({url:t,type:"DELETE",timeout:BTAjax.timeout,dataType:"json",success:function(t){return BTAjax.processSuccess(t,e,n)}})},processSuccess:function(t,e,n){return BTGlobals.netLogging&&trace("got response back","ajaxCall.success"),BTGlobals.netLogging&&trace(t),"ok"===t.status&&null!=e?e(t.result):null!=n?n(t.message):(trace("error..."),null==e&&trace("no call back defined"),trace("data is..."),trace(t))}};var BTBasket;BTBasket={addToBasket:function(t,e){var n;return n=$.cookie(t),n=null==n?[]:JSON.parse(n),n.push(e),$.cookie(t,JSON.stringify(n),{path:"/"})},getBasketContents:function(t){return $.cookie(t)},clearBasket:function(t){return $.removeCookie(t,{path:"/"})},each:function(t,e){var n,i;return(i=$.cookie(t))?(trace("basket is"),trace(i),n=JSON.parse(i),trace("basket parse ok","BTBasket"),$(n).each(function(){return trace("in each for basket"),trace(this),null!=e?e.apply(this):void 0})):void 0},count:function(t){var e,n,i;try{return(n=$.cookie(t))?(trace("basket has content","BTBasket"),e=JSON.parse(n),trace("basket parse ok","BTBasket"),e.length):0}catch(a){i=a,trace(i)}return 0}};Array.prototype.filter||(Array.prototype.filter=function(t){var e,n,i,r;for(r=[],n=0,i=this.length;i>n;n++)e=this[n],t(e)&&r.push(e);return r}),Array.prototype.findIn||(Array.prototype.findIn=function(t){var e,n,i;for(n=0,i=this.length;i>n;n++)if(e=this[n],"function"==typeof t?t(e):void 0)return e}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,i,r,a;for(a=[],n=i=0,r=this.length;r>=0?r>i:i>r;n=r>=0?++i:--i)a.push(t.call(e,this[n],n,this));return a});var BTGlobals,capitalize,objToString,trace;BTGlobals={isInt:function(t){return parseFloat(t)!==parseInt(t)||isNaN(t)?!1:!0},netLogging:!0,getWindowSize:function(){var t,e;return e=0,t=0,"number"==typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth,t=document.body.clientHeight),{w:e,h:t}},getInternetExplorerVersion:function(){var t,e,n;return e=-1,"Microsoft Internet Explorer"===navigator.appName&&(n=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=t.exec(n)&&(e=parseFloat(RegExp.$1))),e},traceError:function(t){return trace("------ error"),null!=t.fileName&&trace(t.fileName),null!=t.message&&trace(t.message),null!=t.lineNumber?trace(t.lineNumber):void 0},readIntoJQueryImage:function(t,e){var n;return null==e?trace("no file","readIntoJQueryImage"):(n=new FileReader,n.onload=function(e){return t.attr("src",e.target.result)},n.readAsDataURL(e))},logging:!0},null!=("undefined"!=typeof console&&null!==console?console.clear:void 0)&&console.clear(),trace=function(t,e){return BTGlobals.logging?null!=("undefined"!=typeof console&&null!==console?console.log:void 0)?null!=e?"object"===$.type(t)?console.log(""+e+" :: "+objToString(t)):console.log(""+e+" :: "+t):console.log(t):void 0:void 0},capitalize=function(t){return t=t.toLowerCase(),t.replace(/([^ -])([^ -]*)/gi,function(t,e,n){return e.toUpperCase()+n})},objToString=function(t){return JSON.stringify(t)},$.fn.extend({fillHeight:function(t){return this.each(function(){return $(this).height($(window).height()-$(this).offset().top-t)})}}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(t){return 0===this.lastIndexOf(t,0)});jQuery.fn.extend({getUrlParam:function(t){t=escape(unescape(t));var e=new Array,n=null;if("#document"==$(this).attr("nodeName"))window.location.search.search(t)>-1&&(n=window.location.search.substr(1,window.location.search.length).split("&"));else if("undefined"!=$(this).attr("src")){var i=$(this).attr("src");if(i.indexOf("?")>-1){var r=i.substr(i.indexOf("?")+1);n=r.split("&")}}else{if("undefined"==$(this).attr("href"))return null;var i=$(this).attr("href");if(i.indexOf("?")>-1){var r=i.substr(i.indexOf("?")+1);n=r.split("&")}}if(null==n)return null;for(var a=0;a<n.length;a++)escape(unescape(n[a].split("=")[0]))==t&&e.push(n[a].split("=")[1]);return 0==e.length?null:1==e.length?e[0]:e}}),$.fn.extend({verticallyAlignChildren:function(){var t=parseFloat($(this).css("height")),e=$(this).children();$(e).each(function(){var e=parseFloat($(this).css("height"))/2;e+=parseFloat($(this).css("margin-top"))/2,e+=parseFloat($(this).css("margin-bottom"))/2,e+=parseFloat($(this).css("padding-bottom"))/2,e+=parseFloat($(this).css("padding-top"))/2;var n=t/2-e;$(this).css("margin-top",n+"px"),$(this).css("margin-bottom",n+"px")})}});var BTLineChart;BTLineChart=function(){function t(t,e){this.divID=t,this.opts=e,this.data={},this.chart=new google.visualization.LineChart(document.getElementById(this.divID))}return t.prototype.setData=function(t,e,n,r){return this.data[t]={values:e},this.data[t].field=n,this.data[t].type=null!=r?r:"number",this.chart.draw(this.getAsDataView(),this.opts)},t.prototype.redraw=function(){return this.chart.draw(this.getAsDataView(),this.opts)},t.prototype.getAsDataView=function(){var t,e,n,r,o,a,i,s;a=new google.visualization.DataTable,t=0;for(e in this.data){for(a.addColumn(this.data[e].type,e),o=this.data[e].values,0===a.getNumberOfRows()&&a.addRows(o.length),n=0,i=0,s=o.length;s>i;i++)r=o[i],null!=this.data[e].field?a.setCell(n,t,parseInt(r[this.data[e].field])):a.setCell(n,t,r),n++;t++}return a},t}();var BTMVC,BTModel,BTView,__bind=function(t,e){return function(){return t.apply(e,arguments)}},__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};BTMVC=function(){function t(){this.invokeListener=__bind(this.invokeListener,this),this.addEvents=__bind(this.addEvents,this),this.evtListeners=[],this.events={}}return t.prototype.addEvents=function(t){return this.events=$.extend(this.events,t)},t.prototype.addListener=function(t,e){return trace("attempt to add listener for "+t),null==this.evtListeners[t]&&(this.evtListeners[t]=[]),this.evtListeners[t].push(e),trace(this.evtListeners)},t.prototype.invokeListener=function(){var t,e,n,r,i,o,s;if(t=arguments[0],n=2<=arguments.length?__slice.call(arguments,1):[],trace("in invokeListener for "+t+" with params...","BTMVC"),trace(n),null==this.evtListeners[t])return trace("No listener found for "+t+" with evt listeners and this context as...","BTMVC"),trace(this.evtListeners),trace(this),void 0;for(n.splice(0,0,t),o=this.evtListeners[t],s=[],r=0,i=o.length;i>r;r++)e=o[r],trace("about to invoke listener for "+t+" with params...","BTMVC"),trace(n),s.push(e.apply(this,n));return s},t.prototype.removeListener=function(t,e){var n;if(null!=this.evtListeners[t]&&(n=this.evtListeners[t].indexOf(e),-1!==n))return this.evtListeners[t].splice(n,1)},t}(),BTView=function(t){function e(t,n){this.divID=t,this.templates=n,this.render=__bind(this.render,this),this.$=__bind(this.$,this),e.__super__.constructor.call(this),this.jq=$(this.divID),0===this.jq.length&&(this.jq=null)}return __extends(e,t),e.prototype.addTemplate=function(t,e){return this.templates[t]=e},e.prototype.getTemplate=function(t){return this.templates[t]},e.prototype.invokeTemplate=function(t,e){return null==this.templates[t]?null:this.templates[t](e)},e.prototype.$=function(){return null===this.jq&&(this.jq=$(this.divID)),this.jq},e.prototype.render=function(t,e){var n;return this.$().empty(),n=this.invokeTemplate(t,e),null!=n?this.$().append(n):trace("could not render template "+t,"BTView")},e}(BTMVC),BTModel=function(t){function e(){e.__super__.constructor.call(this),this.loaders={}}return __extends(e,t),e.prototype.addLoader=function(t,e,n){return this.loaders[t]={name:t,loader:e,modelEvt:n}},e.prototype.runLoader=function(){var t,e,n,r,i;if(n=arguments[0],r=2<=arguments.length?__slice.call(arguments,1):[],null==this.loaders[n])return trace("no loader for "+n),void 0;trace(this.loaders[n].loader),e=this.loaders[n],i=this;try{return r.push(function(t){return e.data=t,trace(t),i.invokeListener(e.modelEvt,e.data)}),this.loaders[n].loader.apply(this,r)}catch(o){return t=o,trace("Something went wrong when running loader : "+t)}},e}(BTMVC);var BTRestfulModel,__bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};BTRestfulModel=function(t){function e(t,n){this.prefix=t,this.suffix=n,this.ajaxDelete=__bind(this.ajaxDelete,this),this.ajaxPost=__bind(this.ajaxPost,this),this.ajaxGet=__bind(this.ajaxGet,this),this["delete"]=__bind(this["delete"],this),this.get=__bind(this.get,this),this.getAll=__bind(this.getAll,this),e.__super__.constructor.call(this),this.addEvents({all:"all",get:"get","delete":"delete",change:"change",error:"error"})}return __extends(e,t),e.prototype.getAll=function(){var t=this;return this.ajaxGet("",function(e){return t.invokeListener(t.events.all,e)})},e.prototype.get=function(t){var e=this;return this.ajaxGet(""+t,function(t){return e.invokeListener(e.events.get,t)})},e.prototype["delete"]=function(t){var e=this;return this.ajaxDelete(""+t,function(t){return e.invokeListener(e.events["delete"],t)})},e.prototype.ajaxGet=function(t,e){var n=this;return BTAjax.get(""+this.prefix+t+this.suffix,e,function(t){return n.invokeListener(n.events.error,t)})},e.prototype.ajaxPost=function(t,e,n){var r=this;return BTAjax.post(""+this.prefix+t+this.suffix,e,n,function(t){return r.invokeListener(r.events.error,t)})},e.prototype.ajaxDelete=function(t,e){var n=this;return BTAjax["delete"](""+this.prefix+t+this.suffix,e,function(t){return n.invokeListener(n.events.error,t)})},e}(BTModel);var BTStateMachine;BTStateMachine=function(){function t(){this.states={},this.txs=[],this.curState=null}return t.prototype.addState=function(t,e,n,r){return null!=this.states[t]?(trace("state "+t+" already exist"),!1):(this.states[t]={enter:e,exit:n,stateParams:r},!0)},t.prototype.swapState=function(t){var e;if(this.curState!==t)return this.invokeOnCurrent("exit"),e=this.getTx(this.curState,t),null!=e&&e.execute(),this.curState=t,this.invokeOnCurrent("enter")},t.prototype.invokeOnCurrent=function(t){var e;return null!=this.curState&&(e=this.states[this.curState],null!=e)?e[t](e.stateParams):void 0},t.prototype.addTx=function(t,e,n){return null!=this.getTx(t,e)?(trace("tx exists for "+t+" -> "+e),void 0):this.txs.push({from:t,to:e,execute:n})},t.prototype.getTx=function(t,e){var n,r,i,s;for(s=this.txs,r=0,i=s.length;i>r;r++)if(n=s[r],n.from===t&&n.to===e)return n;return null},t}();var BTTemplates,addTemplate,runTemplate,__slice=[].slice;BTTemplates={},addTemplate=function(t,e){return BTTemplates[t]={pop:e}},runTemplate=function(){var t,e;return t=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],null!=BTTemplates[t]?BTTemplates[t].pop.apply(this,e):void 0};var BTTmpl,__slice=[].slice;BTTmpl={},$.fn.extend({fromTemplate:function(){var t;return t=1<=arguments.length?__slice.call(arguments,0):[],this.each(function(){var e;return e=$(this).attr("data-templateName"),null==e?(trace("no template name"),this):null!=BTTmpl[e]?(trace("applying template "+e+" with params "+t),BTTmpl[e].apply(this,t)):trace("no template exists with name "+e)})}});var $,DataAttributes;DataAttributes={validate:function(t){var e;return e=!0,$("[data-validate]").each(function(){return""===$(this).val()?(alert($(this).attr("data-validate")),e=!1):void 0}),e&&null!=t?t():void 0},bindTo:function(t){return $("[data-bind]").each(function(){var e,n,i,r,a;if(n=$(this).attr("data-bind"),e=$(this).attr("data-bind-format"),a=$(this).attr("data-bind-target"),null==e&&(e="String"),null!=t[n]&&null!=a){switch(i=null,e){case"String":i=t[n].toString();break;case"FixedNumber":i=parseFloat(t[n]).toFixed(2)}return r=$(this)[a](),null!=r?(r=r.replace("$0",i),$(this)[a](r)):trace("no str defined for binding")}return trace("no "+n+" on object")})}},$=jQuery,$.fn.extend({bindTo:function(t){return this.find("[data-bind]").each(function(){var e,n,i,r,a,o,s;if(r=$(this).attr("data-bind"),i=$(this).attr("data-bind-format"),s=$(this).attr("data-bind-target"),e=$(this).attr("data-bind-expr"),n=$(this).attr("data-bind-attr"),null==i&&(i="String"),null!=t[r]&&null!=s){switch(a=null,i){case"String":a=t[r].toString();break;case"FixedNumber":a=parseFloat(t[r]).toFixed(2)}return o=null==e?$(this)[s]():e,null!=o?(o=o.replace("$0",a),null==n?$(this)[s](o):$(this).attr(s,o)):trace("no str defined for binding")}return trace("no "+r+" on object")})},validate:function(t){var e;return e=!0,this.find("[data-validate]").each(function(){return""===$(this).val()?(alert($(this).attr("data-validate")),e=!1):void 0}),e&&null!=t?t():void 0}});var Dialogs;Dialogs={defaults:{okText:"OK",cancelText:"Cancel",title:"Dialog",divID:"#id_dialogContainer",targetDiv:null,ok:null,body:"",preOK:null,afterShow:null},getDivTarget:function(t){var e;return e=$("body"),null!=t&&(e=$(t)),e},getDivID:function(t,e){return null==t&&(t="#id_"+parseInt(999*Math.random())),$(t).size()>0?$(t).empty():e.append('<div class="modal hide fade" id="'+t.replace("#","")+'">\n</div>'),t},initOKCallback:function(t,e,n){return $(""+t+" .modal-body").keypress(function(r){if(13===r.keyCode){if(null!=n&&!n())return;if($(t).modal("hide"),null!=e)return e()}}),$(""+t+" .modal-footer a.btn-primary").click(function(){return null==n||n()?($(t).modal("hide"),null!=e?e():void 0):void 0})},okCancel:function(t){var e,n,r;return t=$.extend({},Dialogs.defaults,t),n=Dialogs.getDivTarget(t.targetDiv),e=Dialogs.getDivID(t.divID,n),r=""+Dialogs.dlgHeader(t.title)+"\n  "+Dialogs.dlgBody(t.body)+'\n<div class="modal-footer">\n  <a href="#" class="btn" data-dismiss="modal">'+t.cancelText+'</a>\n  <a href="#" class="btn btn-primary">'+t.okText+"</a>\n</div>",$(e).append(r),Dialogs.initOKCallback(e,t.ok,t.preOK),$(e).on("shown",function(){return 0===$(""+e+" .modal-body [autofocus]").size()?$(""+e+" .modal-body").focus():void 0}),null!=t.afterShow&&(trace("after show being invoked","Dialogs"),t.afterShow()),$(e).modal("show")},ok:function(t){var e,n,r;return trace(Dialogs.defaults),t=$.extend({},Dialogs.defaults,t),trace(t),n=Dialogs.getDivTarget(t.targetDiv),e=Dialogs.getDivID(t.divID,n),r=""+Dialogs.dlgHeader(t.title)+"\n"+Dialogs.dlgBody(t.body)+'\n<div class="modal-footer">\n  <a href="#" class="btn btn-primary">'+t.okText+"</a>\n</div>",$(e).append(r),Dialogs.initOKCallback(e,t.ok),$(e).on("shown",function(){return 0===$(""+e+" .modal-body [autofocus]").size()?$(""+e+" .modal-body").focus():void 0}),$(e).modal("show")},dlgHeader:function(t){return'<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3>'+t+"</h3>\n  </div>"},dlgBody:function(t){return'<div class="modal-body" tabindex="0">\n  '+t+"\n</div>"}};var DynamicRemoteList;DynamicRemoteList=function(){function t(t){this.options=t,trace(this.options,"DynamicRemoteList")}return t.prototype.setGenerator=function(t){return this.options.generator=t},t.prototype.instantiate=function(){var t;return this.created?(trace("list already created","instantiate"),void 0):null==this.options.divID?(trace("Parent Div id must be provided","instantiate"),void 0):(null==this.options.listID&&(this.options.listID="id_list"+(new Date).getTime()),t='<ul id="'+this.options.listID+'">\n</ul>',$("#"+this.options.divID).append(t),null!=this.options.listClass&&$("#"+this.options.listID).attr({"class":this.options.listClass}),this.created=!0)},t.prototype.clearAndRefresh=function(){return this.created?($("#"+this.options.listID+" li").remove(),this.currentLI=null,this.currentObj=null,this.previousLI=null,this.previousObj=null,null==this.options.generator?this.setData(this.data):this.options.generator()):(trace("list not created, make sure instantiate has been called","clearAndRefresh"),void 0)},t.prototype.setData=function(t){var e;return this.data=t,e=this,null==this.options.uiFn?null==this.options.labelField?(trace("no label field set and no ui fn set so leaving","setData"),void 0):$(this.data).each(function(){var t,n;return n="<li>"+this[e.options.labelField]+"</li>",$("#"+e.options.listID).append(n),t=this,$("#"+e.options.listID+" li:last-child").click(function(){return e.handleLiClick(this,t)})}):$(this.data).each(function(t){var n,i;return i=e.options.uiFn(this,t),$("#"+e.options.listID).append(i),n=this,$("#"+e.options.listID+" li:last-child").click(function(){return e.handleLiClick(this,n)})})},t.prototype.getCurrentObject=function(){return this.currentObj},t.prototype.getCurrentLI=function(){return this.currentLI},t.prototype.handleLiClick=function(t,e){return trace("click on "+t+" and "+e,"handleLiClick"),this.previousObj=this.currentObj,this.previousLI=this.currentLI,this.currentObj=e,this.currentLI=t,null==this.clickHandler?(trace("No click handler set","handleLiClick"),void 0):(null!=this.options.selClass&&(trace(this.options.selClass),$(this.currentLI).addClass(this.options.selClass),$(this.previousLI).removeClass(this.options.selClass)),this.clickHandler(this.currentObj,this.currentLI,this.previousObj,this.previousLI))},t.prototype.addClickListener=function(t){return this.clickHandler=t},t}();$.fn.extend({uploadHelper:function(t){var e,n;return t=$.extend({name:"file",buttonText:"Upload File",append:""},t),e="ID_"+parseInt(999*Math.random())+"_FILE",this.append('<form target="iframe_'+e+"\" method='POST' enctype='multipart/form-data' enctype='multipart/form-data'>\n<input type=\"file\" id=\"fileInput_"+e+"\" class='hidden' name='"+t.name+"'/>\n<button class='btn' type='button'>"+t.buttonText+"</button>\n"+t.append+"\n</form>\n<iframe class='hidden' id='iframe_"+e+"' />"),this.find("button").click(function(){return trace("click"),$("#fileInput_"+e).trigger("click")}),this.find("iframe").on("load",function(){var e;return trace("iframe is loaded","uploadHelper"),e=$(this).contents().find("body").text(),trace(e),null!=t.uploadComplete?t.uploadComplete(e):void 0}),null!=t.url&&this.find("form").attr("action",t.url),n=this,this.find("input[type='file']").change(function(){var e;return e=$(this).val().split("\\").pop(),trace(e),trace(this.files),null==this.files[0]?trace("No file selected","uploadHelper"):(null!=t.fileSel&&t.fileSel(e,this.files[0]),null!=t.url&&(trace("attempt call of "+t.url),n.find("form").submit(),null!=t.uploadStarted)?t.uploadStarted():void 0)})}});$.fn.extend({imageFileUpload:function(t){var e,n,i,r;if(trace(t),null==t.inputName)return trace("You must supply an input name","imageFileUpload"),void 0;n=!0;try{new FileReader}catch(a){e=a,n=!1}return trace("setting up with file reader support "+n),i="image/png,image/jpeg,image/tiff",r=this,n?(this.append('<input type="file" accept="'+i+'" name="'+t.inputName+"\" class=\"hidden\" style='display: none;'/>\n<img />\n<button type='button'>"+(null==t.buttonText?"Upload Image":t.buttonText)+"</button>"),trace("reging evts"),this.find("button").click(function(){return r.find("input").trigger("click")})):this.append('<input type="file" accept="'+i+'" name="'+t.inputName+'"/>'),this.find("input").change(function(){var e,i;return e=$("input[type=file]").val().split("\\").pop(),trace(e),trace(this.files),null!=t.fileSel&&t.fileSel(e),0===e.length?(r.find("img").remove(),$("<img />").insertAfter(r.find("input")),trace("no file sel..."),void 0):n?(trace("change for file","imageFileUpload"),this.files&&this.files[0]?(i=new FileReader,i.onload=function(t){return r.loaded=!0,r.find("img").attr("src",t.target.result)},i.readAsDataURL(this.files[0])):void 0):void 0})}});var MapManager,gMapUtils;MapManager=function(){function t(t){this.divID=t,this.gb_eventListenerAdded=!1,this.markers=[]}return t.prototype.initialiseDefaultMap=function(t){return null!=this.map?(t(),void 0):this.initialiseMap({center:new google.maps.LatLng(53.53639,-7.844238),zoom:6,streetViewControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP},t)},t.prototype.initialiseMap=function(t,e){var r=this;return this.map=new google.maps.Map(document.getElementById(this.divID),t),google.maps.event.addListener(this.map,"tilesloaded",function(){return trace("map loaded","tilesLoaded"),r.gb_eventListenerAdded?void 0:(r.triggerResize(),r.gb_eventListenerAdded=!0,e())})},t.prototype.triggerResize=function(){return google.maps.event.trigger(this.map,"resize")},t.prototype.addClickListener=function(t){return google.maps.event.addListener(this.map,"click",function(e){return t(e)})},t.prototype.addZoomChangeListener=function(t){var e=this;return google.maps.event.addListener(this.map,"zoom_changed",function(){return t(e.map.getZoom())})},t.prototype.getCurrentZoomLevel=function(){return this.map.getZoom()},t.prototype.latLng=function(t,e){return new google.maps.LatLng(t,e)},t.prototype.getMap=function(){return this.map},t.prototype.bounds=function(){return new google.maps.LatLngBounds},t.prototype.useBounds=function(t){return this.map.fitBounds(t)},t.prototype.setZoom=function(t){return this.map.setZoom(t)},t.prototype.addMarkerClickListener=function(t,e){return google.maps.event.addListener(t,"click",function(){return trace("click on marker"),e()})},t.prototype.createMarker=function(t,e,r,n){var o,i;return i={position:this.latLng(t,e),title:r,map:this.map},null!=n&&(i.icon=n),o=this.createMarkerFromOptions(i),this.markers.push(o),o},t.prototype.createMarkerFromOptions=function(t){return new google.maps.Marker(t)},t.prototype.createSimpleMarker=function(){return this.createMarkerFromOptions({map:this.map})},t.prototype.removeAllMarkers=function(){var t,e,r,n;for(n=this.markers,e=0,r=n.length;r>e;e++)t=n[e],t.setMap(null);return this.markers=[]},t}(),gMapUtils={latLng2Str:function(t){return"lat : "+t.lat()+", lng : "+t.lng()},bnds2Str:function(t){return"ne : "+latLng2Str(t.getNorthEast())+", sw : "+latLng2Str(t.getSouthWest())+", c : "+latLng2Str(t.getCenter())}};var ModalDialog;ModalDialog=function(){function t(){this.created=!1,this.defaults={title:"Title",dlgBody:null,ok:null,id:null,cancelBtnText:"Cancel",okBtnText:"OK",okOnly:!1}}return t.prototype.doModal=function(t,e){var n,i,a,r=this;return $.extend(this.defaults,t),this.created?(null!=t.title&&$("#"+this.defaults.id+"_Title").text(t.title),null!=e&&e(),$("#"+this.defaults.id).modal("show"),void 0):(a="",null!=this.defaults.dlgBody&&("function"===$.type(this.defaults.dlgBody)?a=this.defaults.dlgBody():"string"===$.type(this.defaults.dlgBody)&&(a=this.defaults.dlgBody)),null==this.defaults.id&&(this.defaults.id="id_modal_"+(new Date).getTime()),n="",this.defaults.okOnly||(n='<a href="#" class="btn" data-dismiss="modal">'+this.defaults.cancelBtnText+"</a>"),i='<div class="modal hide fade" id="'+this.defaults.id+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3 id=\''+this.defaults.id+"_Title'>"+this.defaults.title+'</h3>\n  </div>\n  <div class="modal-body">\n    '+a+'\n  </div>\n  <div class="modal-footer">\n    '+n+'\n    <a href="#" class="btn btn-primary" id="id_mainBtn'+this.defaults.id+'">'+this.defaults.okBtnText+"</a>\n  </div>\n</div>",this.created=!0,$("body").append($(i)),0===$("#"+this.defaults.id+" .modal-body [autofocus]").size()&&(trace("applying focus..."),$("#"+this.defaults.id+" .modal-body").focus()),$("#id_mainBtn"+this.defaults.id).click(function(){return null!=r.defaults.ok&&r.defaults.ok(),$("#"+r.defaults.id).modal("hide")}),$("#"+this.defaults.id+" .modal-body").keypress(function(t){return trace("keypress..."),13===t.keyCode?(null!=r.defaults.ok&&r.defaults.ok(),$("#"+r.defaults.id).modal("hide")):void 0}),null!=e&&e(),$("#"+this.defaults.id).modal("show"))},t}();var Table;Table=function(){function t(){}return t.createTable=function(t,e,n,i,a){var r,s,o,l,u,d,c;d='<div class="span'+n+'"><table id="'+e+'" class="table table-striped">\n<thead>\n<tr><td><strong>'+i+"</strong></td></tr>\n</thead>",u="<tbody>",l="</tbody></table></div>";for(r in a)c=a[r],s="<tr><td>"+r+"</td><td>"+c+"</td></tr>",u+=s;return o=d+u+l,$(t).append(o)},t}();var fsm;fsm=new BTStateMachine,$(document).ready(function(){return fsm.addState("rest",function(){return trace("enter rest"),$("#id_curStateTxt").text("rest")},function(){return trace("exit rest")},{msg:"hello"}),fsm.addState("test",function(){return trace("enter test"),$("#id_curStateTxt").text("test")},function(){return trace("exit test")},{msg:"hello from test"}),fsm.addTx("test","rest",function(){return trace("moving from test to rest")}),$("#id_restBtn").click(function(){return trace("click"),fsm.swapState("rest")}),$("#id_testBtn").click(function(){return trace("click"),fsm.swapState("test")})});